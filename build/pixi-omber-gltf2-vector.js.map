{"version":3,"file":"pixi-omber-gltf2-vector.js","sources":["../src/gltf_model.js","../src/renderer.js","../src/loader.js"],"sourcesContent":["/**\r\n * Class for holding a Gltf model\r\n */\r\n\r\nexport class GltfModel extends PIXI.utils.EventEmitter\r\n{\r\n    constructor(json, glbBuffer) \r\n    {\r\n    \tsuper();\r\n        this.json = json;\r\n        this.glbBuffer = glbBuffer;\r\n        // Calculate the min and max values of positions\r\n        this.min = [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY];\r\n        this.max = [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY];\r\n        this.walkScenePrimitives((primitive) => {\r\n            if (!('POSITION' in primitive.attributes)) return;\r\n            const positionAccessor = this.json.accessors[primitive.attributes.POSITION];\r\n            for (let n = 0; n < 3; n++)\r\n        \t{\r\n                this.min[n] = Math.min(this.min[n], positionAccessor.min[n]);\r\n                this.max[n] = Math.max(this.max[n], positionAccessor.max[n]);\r\n        \t}\r\n        });\r\n        // Try to find z-separation values so that we can easily order shapes\r\n        let zSeparation = 0.0;\r\n        if ('asset' in this.json && 'extras' in this.json.asset && typeof(this.json.asset.extras) == 'object')\r\n    \t{\r\n        \tif ('OMBER_zSeparation' in this.json.asset.extras)\r\n        \t\tthis.zSeparation = this.json.asset.extras.OMBER_zSeparation; \r\n    \t}\r\n    }\r\n\r\n    destroy()\r\n    {\r\n    \tthis.dispose();\r\n    \tsuper.destroy();\r\n    }\r\n    \r\n    dispose()\r\n    {\r\n    \tthis.emit('dispose', this);\r\n    }\r\n    \r\n    walkScenePrimitives(primitiveHandler) \r\n    {\r\n    \tlet gltfJson = this.json;\r\n        let sceneNum = 0;\r\n        if ('scene' in gltfJson) sceneNum = gltfJson.scene;\r\n        const scene = gltfJson.scenes[sceneNum];\r\n        scene.nodes.forEach( node => GltfModel.walkNodesPrimitives(gltfJson, gltfJson.nodes[node], primitiveHandler));\r\n    }\r\n    static walkNodesPrimitives(gltfJson, node, primitiveHandler) \r\n    {\r\n        if ('children' in node) \r\n        {\r\n            node.children.forEach( node => this.walkNodesPrimitives(gltfJson, gltfJson.nodes[node], primitiveHandler));\r\n        }\r\n        // TODO: Handle transformation matrices\r\n        if ('mesh' in node) \r\n        {\r\n            this.walkMeshPrimitives(gltfJson.meshes[node.mesh], primitiveHandler);\r\n        }\r\n    }\r\n    static walkMeshPrimitives(mesh, primitiveHandler) \r\n    {\r\n        if ('primitives' in mesh) \r\n        {\r\n            mesh.primitives.forEach( primitive => primitiveHandler(primitive) );\r\n        }\r\n    }\r\n    \r\n    static parseGltf(json, buffer) \r\n    {\r\n        let gltf = new GltfModel(json, buffer);\r\n        return gltf;\r\n    }\r\n}\r\n","import {GltfModel} from './gltf_model.js';\r\n\r\nconst VertexProgram = \r\n`attribute vec3 aVertexPosition;\r\nattribute vec4 aColor;\r\nvarying lowp vec4 vColor;\r\nuniform mat4 transformMatrix;\r\nvoid main(void) {\r\n    gl_Position = transformMatrix * vec4(aVertexPosition, 1.0);\r\n    vColor = aColor;\r\n}`;\r\n\r\nconst FragmentProgram = \r\n`varying lowp vec4 vColor;\r\nvoid main(void) {\r\n\tgl_FragColor  = vColor;\r\n}`;\r\n\r\nclass VectorMeshShader extends PIXI.Shader\r\n{\r\n\tconstructor(gl) \r\n    {\r\n\t\tsuper(gl, VertexProgram, FragmentProgram);\r\n        this.transformMatrix = new PIXI.Matrix();\r\n\t\tthis.transformMatrix4x4 = new Float32Array(16);\r\n\t}\r\n}\r\n\r\nclass VectorMeshRenderer extends PIXI.ObjectRenderer\r\n{\r\n\tconstructor(renderer) \r\n    {\r\n\t\tsuper(renderer);\r\n\t\tthis.isActive = false;\r\n\t\t\r\n\t\t// Keep track of VAOs set-up for the meshes in a gltf\r\n\t\tthis.primitiveVaos = new Map();\r\n\t\tthis.gltfVaoSetup = new Set();\r\n\t\t\r\n\t\tthis.renderer.on('prerender', this.onPrerender, this);\r\n\t}\r\n\tonPrerender()\r\n\t{\r\n\t\t// Reset the positions of objects in z buffer at the start of\r\n\t\t// rendering\r\n\t\tthis.zNext = 1 - this.zBufferSeparation; \r\n\t}\r\n\tonContextChange() \r\n    {\r\n\t\tlet gl = this.renderer.gl;\r\n\t\tthis.shader = new VectorMeshShader(gl);\r\n\t}\r\n\tdestroy()\r\n\t{\r\n\t\tthis.renderer.off('prerender', this.onPrerender, this);\r\n\t\tif (this.shader)\r\n\t\t{\r\n\t\t\tthis.shader.destroy();\r\n\t\t}\r\n\t\tthis.shader = null;\r\n\t}\r\n\tstart()\r\n\t{\r\n\t\tsuper.start();\r\n\t\tif (!this.isActive) {\r\n\t\t\t// If the VectorMeshRenderer is the active renderer when finished rendering,\r\n\t\t\t// then stop() won't be called at the end of the rendering. But start() will\r\n\t\t\t// still be called at the start of the next rendering, so we have to avoid\r\n\t\t\t// push new state\r\n\t\t\tthis.renderer.state.push();\r\n\t\t\tthis.renderer.state.setDepthTest(true);\r\n\t        // Turn on blending with back-to-front rendering and without pre-multiplied alpha\r\n\t        this.renderer.state.setBlend(true);\r\n\t        this.renderer.state.setBlendMode(PIXI.BLEND_MODES.NORMAL_NPM);\r\n\t\t}\r\n\t\tthis.isActive = true;\r\n\t}\r\n\tstop()\r\n\t{\r\n\t\tsuper.stop();\r\n\t\tthis.renderer.state.pop();\r\n\t\tthis.isActive = false;\r\n\t}\r\n\trender(vectorMesh) \r\n    {\r\n\t\tconst gl = this.renderer.gl;\r\n        const gltf = vectorMesh.gltf;\r\n        this.setupVaos(gl, gltf);\r\n\t\tthis.renderer.bindShader(this.shader);\r\n        this.renderVaos(gl, vectorMesh, gltf);\r\n\t}\r\n    setupVaos(gl, gltf) \r\n    {\r\n        if (this.gltfVaoSetup.has(gltf)) return;\r\n        const renderer = this.renderer;\r\n        \r\n        gltf.walkScenePrimitives((primitive) => {\r\n            // Omber GLTF data uses vertex colors (with alpha) and positions\r\n            // and triangle mode\r\n            if (!('COLOR_0' in primitive.attributes)) return;\r\n            if (!('POSITION' in primitive.attributes)) return;\r\n            if (('mode' in primitive) && primitive.mode !== 4) return;\r\n            const colorAccessor = gltf.json.accessors[primitive.attributes.COLOR_0];\r\n            const positionAccessor = gltf.json.accessors[primitive.attributes.POSITION];\r\n            if (colorAccessor.type != 'VEC4') return;\r\n            if (colorAccessor.bufferView !== positionAccessor.bufferView) return;\r\n            if (colorAccessor.count !== positionAccessor.count) return;\r\n            if (positionAccessor.componentType !== 5126) return;\r\n            if (colorAccessor.componentType !== 5126 && colorAccessor.componentType !== 5121) return;\r\n            let indexAccessor = null;\r\n            if ('indices' in primitive)\r\n            {\r\n                indexAccessor = gltf.json.accessors[primitive.indices];\r\n                if (indexAccessor.componentType !== 5123) return;\r\n            }\r\n            \r\n            // Set up array buffers\r\n            const bufferView = gltf.json.bufferViews[colorAccessor.bufferView];\r\n            let buffer = gltf.glbBuffer.buffer;\r\n            // Only do glb right now\r\n            if ('uri' in gltf.json.buffers[bufferView.buffer]) return;\r\n            const arraybuffer = buffer.slice(gltf.glbBuffer.byteOffset + bufferView.byteOffset, gltf.glbBuffer.byteOffset + bufferView.byteOffset + bufferView.byteLength);\r\n            const vertexBuffer = PIXI.glCore.GLBuffer.createVertexBuffer(gl, null, gl.STATIC_DRAW);\r\n            vertexBuffer.upload(arraybuffer, 0, false);\r\n            \r\n            // Set up VAO\r\n            const vao = renderer.createVao();\r\n            vao.addAttribute(vertexBuffer, this.shader.attributes.aVertexPosition, gl.FLOAT, !!positionAccessor.normalized, bufferView.byteStride, positionAccessor.byteOffset);\r\n            if (colorAccessor.componentType === 5126) \r\n            {\r\n                vao.addAttribute(vertexBuffer, this.shader.attributes.aColor, gl.FLOAT, !!colorAccessor.normalized, bufferView.byteStride, colorAccessor.byteOffset);\r\n            }\r\n            else if (colorAccessor.componentType === 5121) \r\n            {\r\n                vao.addAttribute(vertexBuffer, this.shader.attributes.aColor, gl.UNSIGNED_BYTE, !!colorAccessor.normalized, bufferView.byteStride, colorAccessor.byteOffset);\r\n            }\r\n            let indexBuffer;\r\n            if (indexAccessor != null)\r\n            {\r\n                // TODO: unwind properly if error\r\n                const idxBufferView = gltf.json.bufferViews[indexAccessor.bufferView];\r\n                let buffer = gltf.glbBuffer.buffer;\r\n                // Only do glb right now\r\n                if ('uri' in gltf.json.buffers[idxBufferView.buffer]) return;\r\n                const idxArrayBuffer = buffer.slice(gltf.glbBuffer.byteOffset + idxBufferView.byteOffset, gltf.glbBuffer.byteOffset + idxBufferView.byteOffset + idxBufferView.byteLength);\r\n                indexBuffer = PIXI.glCore.GLBuffer.createIndexBuffer(gl, idxArrayBuffer, gl.STATIC_DRAW);\r\n                vao.addIndex(indexBuffer);\r\n            }\r\n            \r\n            // Save the VAO\r\n            let vaoCount;\r\n            if (indexAccessor != null)\r\n            \tvaoCount = indexAccessor.count;\r\n            else\r\n            \tvaoCount = colorAccessor.count;\r\n            this.primitiveVaos.set(primitive, \r\n            \t\t{\r\n            \t\t\tvao: vao,\r\n            \t\t\tvaoCount: vaoCount,\r\n            \t\t\tvertexBuffer: vertexBuffer,\r\n            \t\t\tindexBuffer: indexBuffer\r\n            \t\t});\r\n        });\r\n        // Mark that VAOs have been set-up for the gltf \r\n        this.gltfVaoSetup.add(gltf);\r\n        gltf.on('dispose', this.onDisposeGltfVaos, this);\r\n    }\r\n    renderVaos(gl, vectorMesh, gltf) \r\n    {\r\n    \tlet zScale = -1.0;\r\n    \tif (gltf.zSeparation)\r\n\t\t{\r\n            zScale = -1.0 / gltf.zSeparation * this.zBufferSeparation;\r\n\t\t}\r\n        let zOffset = -gltf.min[2] * zScale + this.zNext;\r\n        let zSkip = (gltf.max[2] - gltf.min[2]) * zScale - this.zBufferSeparation;\r\n\r\n        // Render opaque objects first\r\n    \tgltf.walkScenePrimitives((primitive) => {\r\n    \t\tif (!('material' in primitive)) return;\r\n    \t\tconst mat = gltf.json.materials[primitive.material];\r\n    \t\tif (!('alphaMode' in mat) || mat.alphaMode == 'OPAQUE')\r\n    \t\t\tthis.renderPrimitive(primitive, vectorMesh, zScale, zOffset);\r\n        });\r\n    \t// Then render transparent ones in order\r\n    \tgltf.walkScenePrimitives((primitive) => {\r\n    \t\tif ('material' in primitive)\r\n\t\t\t{\r\n        \t\tconst mat = gltf.json.materials[primitive.material];\r\n        \t\tif (!('alphaMode' in mat) || mat.alphaMode == 'OPAQUE')\r\n        \t\t\treturn;\r\n\t\t\t}\r\n            this.renderPrimitive(primitive, vectorMesh, zScale, zOffset);\r\n        });\r\n    \tthis.zNext += zSkip;\r\n    }\r\n    renderPrimitive(primitive, vectorMesh, zScale, zOffset)\r\n    {\r\n    \tconst vao = this.primitiveVaos.get(primitive);\r\n        if (!vao) return;\r\n        // Multiply the MVP matrix in advance instead of in shader\r\n        this.renderer._activeRenderTarget.projectionMatrix.copy(this.shader.transformMatrix).append(vectorMesh.worldTransform);\r\n\t\tlet matrix = this.shader.transformMatrix4x4;\r\n\t\tmatrix[0] = this.shader.transformMatrix.a;\r\n\t\tmatrix[1] = this.shader.transformMatrix.b;\r\n\t\tmatrix[2] = 0;\r\n\t\tmatrix[3] = 0;\r\n\t\tmatrix[4] = -this.shader.transformMatrix.c;\r\n\t\tmatrix[5] = -this.shader.transformMatrix.d;\r\n\t\tmatrix[6] = 0;\r\n\t\tmatrix[7] = 0;\r\n\t\tmatrix[8] = 0;\r\n\t\tmatrix[9] = 0;\r\n\t\tmatrix[10] = zScale;\r\n\t\tmatrix[11] = 0;\r\n\t\tmatrix[12] = this.shader.transformMatrix.tx;\r\n\t\tmatrix[13] = this.shader.transformMatrix.ty;\r\n\t\tmatrix[14] = zOffset;\r\n\t\tmatrix[15] = 1;\r\n        this.shader.uniforms.transformMatrix = matrix;\r\n        this.renderer.bindVao(vao.vao);\r\n        vao.vao.draw(this.renderer.gl.TRIANGLES, vao.vaoCount, 0);\r\n    }\r\n    \r\n    // When a GltfModel is disposed, we need to clear all the WebGL VAOs associated\r\n    // with it\r\n    onDisposeGltfVaos(gltf)\r\n    {\r\n    \tgltf.off('dispose', this.onDisposeGltfVaos, this);\r\n\r\n    \t// Destroy the VAOs and other GL buffers for each primitive\r\n    \tgltf.walkScenePrimitives((primitive) => {\r\n        \tconst vao = this.primitiveVaos.get(primitive);\r\n        \tvao.vao.destroy();\r\n        \tvao.vertexBuffer.destroy();\r\n        \tif (vao.indexBuffer) vao.indexBuffer.destroy();\r\n            this.primitiveVaos.delete(primitive);\r\n        });\r\n        this.gltfVaoSetup.delete(gltf);\r\n    }\r\n}\r\nVectorMeshRenderer.prototype.shader = null;\r\nVectorMeshRenderer.prototype.zNext = 0.0;\r\n// Rescale things to use as much of the depth buffer as possible\r\n// (assuming a 16-bit linear depth buffer)\r\nVectorMeshRenderer.prototype.zBufferSeparation = 1.0 / 32000;\r\n\r\n\r\nexport class VectorMesh extends PIXI.Container \r\n{\r\n\tconstructor(gltf) \r\n    {\r\n\t\tsuper();\r\n        if (!(gltf instanceof GltfModel)) throw 'Expecting GLTF data loaded from Omber GLTF loader';\r\n        this.gltf = gltf;\r\n\t}\r\n\t_renderWebGL(renderer)\r\n\t{\r\n\t\trenderer.setObjectRenderer(renderer.plugins.omber);\r\n\t\trenderer.plugins.omber.render(this);\r\n\t}\r\n\t// Omber isn't a good fit for the height/width/hitarea model used by Pixi.js\r\n\t// because its glTF meshes have a default anchor point that isn't in the upper-left corner.\r\n\tget width() {\r\n\t\treturn this.scale.x * (this.gltf.max[0] - this.gltf.min[0]);\r\n\t}\r\n\tset width(val) {\r\n\t\tthis.scale.x = val / (this.gltf.max[0] - this.gltf.min[0]);\r\n\t}\r\n\tget height() {\r\n\t\treturn this.scale.y * (this.gltf.max[1] - this.gltf.min[1]);\r\n\t}\r\n\tset height(val) {\r\n\t\tthis.scale.y = val / (this.gltf.max[1] - this.gltf.min[1]);\r\n\t}\r\n\tcontainsPoint(pt)\r\n\t{\r\n\t\tconst localPt = this.worldTransform.applyInverse(pt);\r\n\t\treturn localPt.x >= this.gltf.min[0] && localPt.x <= this.gltf.max[0]\r\n\t\t\t\t&& localPt.y <= -this.gltf.min[1] && localPt.y >= -this.gltf.max[1];\r\n\t}\r\n}\r\n\r\n\r\n// WebGL only\r\nPIXI.WebGLRenderer.registerPlugin('omber', VectorMeshRenderer);\r\n\r\n","import {GltfModel} from './gltf_model.js';\r\n\r\n\r\nfunction loadGlb(resource) \r\n{\r\n\tresource.omberMesh = true;\r\n\tlet dataView = new DataView(resource.data);\r\n\tlet magic = dataView.getUint32(0, true);\r\n\tif (magic != 0x46546C67) return;  // 'glTF'\r\n\tlet version = dataView.getUint32(4, true);\r\n\tif (version != 2) return;\r\n\tlet fileLength = dataView.getUint32(8, true);\r\n\tlet json = null;\r\n\tlet binBuffer = null;\r\n\tfor (let offset = 12; offset < fileLength;) \r\n    {\r\n\t\tlet chunkLength = dataView.getUint32(offset, true);\r\n\t\tlet chunkType = dataView.getUint32(offset + 4, true);\r\n\t\tif (chunkType == 0x4E4F534A)   // 'JSON'\r\n        {\r\n            json = JSON.parse(new TextDecoder().decode(new Uint8Array(resource.data, offset + 8,  chunkLength)));\r\n\t\t} else if (chunkType == 0x004E4942)   // 'BIN'\r\n        {\r\n\t\t\tbinBuffer = new DataView(resource.data, offset + 8,  chunkLength);\r\n\t\t}\r\n\t\toffset = offset + 8 + chunkLength;\r\n\t}\r\n    resource.gltf = GltfModel.parseGltf(json, binBuffer);\r\n}\r\n\r\nexport function omberGlbLoad(resource, next) \r\n{\r\n    if (resource.data && resource.extension == 'glb')\r\n    {\r\n        loadGlb(resource);\r\n    }\r\n    next();\r\n}\r\n\r\n\r\n// New loaders will be configured to support loading .glb files.\r\nPIXI.loaders.Resource.setExtensionXhrType('glb', PIXI.loaders.Resource.XHR_RESPONSE_TYPE.BUFFER);\r\nPIXI.loaders.Resource.setExtensionLoadType('glb', PIXI.loaders.Resource.LOAD_TYPE.XHR);\r\nPIXI.loaders.Loader.addPixiMiddleware(() => omberGlbLoad);\r\n\r\n// The premade shared PIXI loader has already been created though (only new loaders \r\n// will have .glb support added to it automatically), so .glb support needs to be \r\n// added to the shared PIXI loader separately.\r\nPIXI.loader.use(omberGlbLoad);"],"names":[],"mappings":";;;;AAAA;;;;AAIA,AAAO,MAAM,SAAS,SAAS,IAAI,CAAC,KAAK,CAAC,YAAY;AACtD;IACI,WAAW,CAAC,IAAI,EAAE,SAAS;IAC3B;KACC,KAAK,EAAE,CAAC;QACL,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;;QAE3B,IAAI,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,iBAAiB,EAAE,MAAM,CAAC,iBAAiB,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC;QAC1F,IAAI,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,iBAAiB,EAAE,MAAM,CAAC,iBAAiB,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC;QAC1F,IAAI,CAAC,mBAAmB,CAAC,CAAC,SAAS,KAAK;YACpC,IAAI,EAAE,UAAU,IAAI,SAAS,CAAC,UAAU,CAAC,EAAE,OAAO;YAClD,MAAM,gBAAgB,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;YAC5E,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;SAC7B;gBACO,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC7D,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;UACnE;SACD,CAAC,CAAC;;QAEH,IAAI,WAAW,GAAG,GAAG,CAAC;QACtB,IAAI,OAAO,IAAI,IAAI,CAAC,IAAI,IAAI,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,QAAQ;KACxG;SACI,IAAI,mBAAmB,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM;UAChD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,iBAAiB,CAAC;MAChE;KACD;;IAED,OAAO;IACP;KACC,IAAI,CAAC,OAAO,EAAE,CAAC;KACf,KAAK,CAAC,OAAO,EAAE,CAAC;KAChB;;IAED,OAAO;IACP;KACC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;KAC3B;;IAED,mBAAmB,CAAC,gBAAgB;IACpC;KACC,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC;QACtB,IAAI,QAAQ,GAAG,CAAC,CAAC;QACjB,IAAI,OAAO,IAAI,QAAQ,EAAE,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC;QACnD,MAAM,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACxC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,IAAI,SAAS,CAAC,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC;KACjH;IACD,OAAO,mBAAmB,CAAC,QAAQ,EAAE,IAAI,EAAE,gBAAgB;IAC3D;QACI,IAAI,UAAU,IAAI,IAAI;QACtB;YACI,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,IAAI,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC;SAC9G;;QAED,IAAI,MAAM,IAAI,IAAI;QAClB;YACI,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,gBAAgB,CAAC,CAAC;SACzE;KACJ;IACD,OAAO,kBAAkB,CAAC,IAAI,EAAE,gBAAgB;IAChD;QACI,IAAI,YAAY,IAAI,IAAI;QACxB;YACI,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,SAAS,IAAI,gBAAgB,CAAC,SAAS,CAAC,EAAE,CAAC;SACvE;KACJ;;IAED,OAAO,SAAS,CAAC,IAAI,EAAE,MAAM;IAC7B;QACI,IAAI,IAAI,GAAG,IAAI,SAAS,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QACvC,OAAO,IAAI,CAAC;KACf;CACJ;;AC1ED,MAAM,aAAa;AACnB,CAAC;;;;;;;CAOA,CAAC,CAAC;;AAEH,MAAM,eAAe;AACrB,CAAC;;;CAGA,CAAC,CAAC;;AAEH,MAAM,gBAAgB,SAAS,IAAI,CAAC,MAAM;AAC1C;CACC,WAAW,CAAC,EAAE;IACX;EACF,KAAK,CAAC,EAAE,EAAE,aAAa,EAAE,eAAe,CAAC,CAAC;QACpC,IAAI,CAAC,eAAe,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;EAC/C,IAAI,CAAC,kBAAkB,GAAG,IAAI,YAAY,CAAC,EAAE,CAAC,CAAC;EAC/C;CACD;;AAED,MAAM,kBAAkB,SAAS,IAAI,CAAC,cAAc;AACpD;CACC,WAAW,CAAC,QAAQ;IACjB;EACF,KAAK,CAAC,QAAQ,CAAC,CAAC;EAChB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;;;EAGtB,IAAI,CAAC,aAAa,GAAG,IAAI,GAAG,EAAE,CAAC;EAC/B,IAAI,CAAC,YAAY,GAAG,IAAI,GAAG,EAAE,CAAC;;EAE9B,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;EACtD;CACD,WAAW;CACX;;;EAGC,IAAI,CAAC,KAAK,GAAG,CAAC,GAAG,IAAI,CAAC,iBAAiB,CAAC;EACxC;CACD,eAAe;IACZ;EACF,IAAI,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;EAC1B,IAAI,CAAC,MAAM,GAAG,IAAI,gBAAgB,CAAC,EAAE,CAAC,CAAC;EACvC;CACD,OAAO;CACP;EACC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;EACvD,IAAI,IAAI,CAAC,MAAM;EACf;GACC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;GACtB;EACD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;EACnB;CACD,KAAK;CACL;EACC,KAAK,CAAC,KAAK,EAAE,CAAC;EACd,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;;;;;GAKnB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;GAC3B,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;;SAEjC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;SACnC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;GACpE;EACD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;EACrB;CACD,IAAI;CACJ;EACC,KAAK,CAAC,IAAI,EAAE,CAAC;EACb,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;EAC1B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;EACtB;CACD,MAAM,CAAC,UAAU;IACd;EACF,MAAM,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;QACtB,MAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC;QAC7B,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;EAC/B,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAChC,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;EAC5C;IACE,SAAS,CAAC,EAAE,EAAE,IAAI;IAClB;QACI,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,OAAO;QACxC,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;;QAE/B,IAAI,CAAC,mBAAmB,CAAC,CAAC,SAAS,KAAK;;;YAGpC,IAAI,EAAE,SAAS,IAAI,SAAS,CAAC,UAAU,CAAC,EAAE,OAAO;YACjD,IAAI,EAAE,UAAU,IAAI,SAAS,CAAC,UAAU,CAAC,EAAE,OAAO;YAClD,IAAI,CAAC,MAAM,IAAI,SAAS,KAAK,SAAS,CAAC,IAAI,KAAK,CAAC,EAAE,OAAO;YAC1D,MAAM,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YACxE,MAAM,gBAAgB,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;YAC5E,IAAI,aAAa,CAAC,IAAI,IAAI,MAAM,EAAE,OAAO;YACzC,IAAI,aAAa,CAAC,UAAU,KAAK,gBAAgB,CAAC,UAAU,EAAE,OAAO;YACrE,IAAI,aAAa,CAAC,KAAK,KAAK,gBAAgB,CAAC,KAAK,EAAE,OAAO;YAC3D,IAAI,gBAAgB,CAAC,aAAa,KAAK,IAAI,EAAE,OAAO;YACpD,IAAI,aAAa,CAAC,aAAa,KAAK,IAAI,IAAI,aAAa,CAAC,aAAa,KAAK,IAAI,EAAE,OAAO;YACzF,IAAI,aAAa,GAAG,IAAI,CAAC;YACzB,IAAI,SAAS,IAAI,SAAS;YAC1B;gBACI,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;gBACvD,IAAI,aAAa,CAAC,aAAa,KAAK,IAAI,EAAE,OAAO;aACpD;;;YAGD,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YACnE,IAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;;YAEnC,IAAI,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,OAAO;YAC1D,MAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,CAAC,CAAC;YAC/J,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,kBAAkB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,CAAC,WAAW,CAAC,CAAC;YACvF,YAAY,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;;;YAG3C,MAAM,GAAG,GAAG,QAAQ,CAAC,SAAS,EAAE,CAAC;YACjC,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,eAAe,EAAE,EAAE,CAAC,KAAK,EAAE,CAAC,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAU,CAAC,UAAU,EAAE,gBAAgB,CAAC,UAAU,CAAC,CAAC;YACpK,IAAI,aAAa,CAAC,aAAa,KAAK,IAAI;YACxC;gBACI,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,KAAK,EAAE,CAAC,CAAC,aAAa,CAAC,UAAU,EAAE,UAAU,CAAC,UAAU,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;aACxJ;iBACI,IAAI,aAAa,CAAC,aAAa,KAAK,IAAI;YAC7C;gBACI,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,aAAa,EAAE,CAAC,CAAC,aAAa,CAAC,UAAU,EAAE,UAAU,CAAC,UAAU,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;aAChK;YACD,IAAI,WAAW,CAAC;YAChB,IAAI,aAAa,IAAI,IAAI;YACzB;;gBAEI,MAAM,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;gBACtE,IAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;;gBAEnC,IAAI,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,OAAO;gBAC7D,MAAM,cAAc,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,aAAa,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,aAAa,CAAC,UAAU,GAAG,aAAa,CAAC,UAAU,CAAC,CAAC;gBAC3K,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,EAAE,EAAE,cAAc,EAAE,EAAE,CAAC,WAAW,CAAC,CAAC;gBACzF,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;aAC7B;;;YAGD,IAAI,QAAQ,CAAC;YACb,IAAI,aAAa,IAAI,IAAI;aACxB,QAAQ,GAAG,aAAa,CAAC,KAAK,CAAC;;aAE/B,QAAQ,GAAG,aAAa,CAAC,KAAK,CAAC;YAChC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,SAAS;cAC9B;eACC,GAAG,EAAE,GAAG;eACR,QAAQ,EAAE,QAAQ;eAClB,YAAY,EAAE,YAAY;eAC1B,WAAW,EAAE,WAAW;eACxB,CAAC,CAAC;SACR,CAAC,CAAC;;QAEH,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC5B,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;KACpD;IACD,UAAU,CAAC,EAAE,EAAE,UAAU,EAAE,IAAI;IAC/B;KACC,IAAI,MAAM,GAAG,CAAC,GAAG,CAAC;KAClB,IAAI,IAAI,CAAC,WAAW;EACvB;YACU,MAAM,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC;GACnE;QACK,IAAI,OAAO,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC;QACjD,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC;;;KAG7E,IAAI,CAAC,mBAAmB,CAAC,CAAC,SAAS,KAAK;MACvC,IAAI,EAAE,UAAU,IAAI,SAAS,CAAC,EAAE,OAAO;MACvC,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;MACpD,IAAI,EAAE,WAAW,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,SAAS,IAAI,QAAQ;OACrD,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,UAAU,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;SAC3D,CAAC,CAAC;;KAEN,IAAI,CAAC,mBAAmB,CAAC,CAAC,SAAS,KAAK;MACvC,IAAI,UAAU,IAAI,SAAS;GAC9B;UACO,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;UACpD,IAAI,EAAE,WAAW,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,SAAS,IAAI,QAAQ;WACrD,OAAO;IACd;YACQ,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,UAAU,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;SAChE,CAAC,CAAC;KACN,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC;KACpB;IACD,eAAe,CAAC,SAAS,EAAE,UAAU,EAAE,MAAM,EAAE,OAAO;IACtD;KACC,MAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAC3C,IAAI,CAAC,GAAG,EAAE,OAAO;;QAEjB,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;EAC7H,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC;EAC5C,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;EAC1C,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;EAC1C,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACd,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACd,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;EAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;EAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACd,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACd,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACd,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACd,MAAM,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC;EACpB,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;EACf,MAAM,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC;EACrB,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QACT,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,eAAe,GAAG,MAAM,CAAC;QAC9C,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAC/B,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,EAAE,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;KAC7D;;;;IAID,iBAAiB,CAAC,IAAI;IACtB;KACC,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;;;KAGlD,IAAI,CAAC,mBAAmB,CAAC,CAAC,SAAS,KAAK;SACpC,MAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;SAC9C,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;SAClB,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC;SAC3B,IAAI,GAAG,CAAC,WAAW,EAAE,GAAG,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;YAC5C,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;SACxC,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KAClC;CACJ;AACD,kBAAkB,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;AAC3C,kBAAkB,CAAC,SAAS,CAAC,KAAK,GAAG,GAAG,CAAC;;;AAGzC,kBAAkB,CAAC,SAAS,CAAC,iBAAiB,GAAG,GAAG,GAAG,KAAK,CAAC;;;AAG7D,AAAO,MAAM,UAAU,SAAS,IAAI,CAAC,SAAS;AAC9C;CACC,WAAW,CAAC,IAAI;IACb;EACF,KAAK,EAAE,CAAC;QACF,IAAI,EAAE,IAAI,YAAY,SAAS,CAAC,EAAE,MAAM,mDAAmD,CAAC;QAC5F,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;EACvB;CACD,YAAY,CAAC,QAAQ;CACrB;EACC,QAAQ,CAAC,iBAAiB,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;EACnD,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EACpC;;;CAGD,IAAI,KAAK,GAAG;EACX,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAC5D;CACD,IAAI,KAAK,CAAC,GAAG,EAAE;EACd,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3D;CACD,IAAI,MAAM,GAAG;EACZ,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAC5D;CACD,IAAI,MAAM,CAAC,GAAG,EAAE;EACf,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3D;CACD,aAAa,CAAC,EAAE;CAChB;EACC,MAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;EACrD,OAAO,OAAO,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;OAChE,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EACtE;CACD;;;;AAID,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAC;;AC1R/D,SAAS,OAAO,CAAC,QAAQ;AACzB;CACC,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC;CAC1B,IAAI,QAAQ,GAAG,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;CAC3C,IAAI,KAAK,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;CACxC,IAAI,KAAK,IAAI,UAAU,EAAE,OAAO;CAChC,IAAI,OAAO,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;CAC1C,IAAI,OAAO,IAAI,CAAC,EAAE,OAAO;CACzB,IAAI,UAAU,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;CAC7C,IAAI,IAAI,GAAG,IAAI,CAAC;CAChB,IAAI,SAAS,GAAG,IAAI,CAAC;CACrB,KAAK,IAAI,MAAM,GAAG,EAAE,EAAE,MAAM,GAAG,UAAU;IACtC;EACF,IAAI,WAAW,GAAG,QAAQ,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;EACnD,IAAI,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;EACrD,IAAI,SAAS,IAAI,UAAU;QACrB;YACI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,IAAI,UAAU,CAAC,QAAQ,CAAC,IAAI,EAAE,MAAM,GAAG,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;GAC9G,MAAM,IAAI,SAAS,IAAI,UAAU;QAC5B;GACL,SAAS,GAAG,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,MAAM,GAAG,CAAC,GAAG,WAAW,CAAC,CAAC;GAClE;EACD,MAAM,GAAG,MAAM,GAAG,CAAC,GAAG,WAAW,CAAC;EAClC;IACE,QAAQ,CAAC,IAAI,GAAG,SAAS,CAAC,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;CACxD;;AAED,AAAO,SAAS,YAAY,CAAC,QAAQ,EAAE,IAAI;AAC3C;IACI,IAAI,QAAQ,CAAC,IAAI,IAAI,QAAQ,CAAC,SAAS,IAAI,KAAK;IAChD;QACI,OAAO,CAAC,QAAQ,CAAC,CAAC;KACrB;IACD,IAAI,EAAE,CAAC;CACV;;;;AAID,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,mBAAmB,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;AACjG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,oBAAoB,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AACvF,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,iBAAiB,CAAC,MAAM,YAAY,CAAC,CAAC;;;;;AAK1D,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,YAAY,CAAC;;;;;;;;;;"}